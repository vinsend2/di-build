ScrollReveal().reveal(".hero__title ", { delay: 500 });
ScrollReveal().reveal(".text-content", { delay: 1500 });


ScrollReveal().reveal(".wwd-card", {
  delay: 500,
  origin: "left",
  distance: "120px",
  easing: "ease-in-out",
});

"use strict";

const $ = (x, parent = document) => {
  return parent.querySelector(x);
}

const catalogToogle = () => {
 document.querySelector('.filter__item--catalog .main-list__link').parentNode.addEventListener("click", () => {
  $('.catalog-menu .menu__box').classList.remove('menu__box--hide')
  $('.catalog-menu .menu__box').classList.add('menu__box--open')
  });
  $('.close-btn').addEventListener("click", () => {
    $('.catalog-menu .menu__box').classList.remove('menu__box--open')
    $('.catalog-menu .menu__box').classList.add('menu__box--hide')
    });
}

const html = document.querySelector("html");

const initFixedHeader = () => {
  const header = document.querySelector(".header");
  const menu = document.querySelector(".menu");
  const body = document.querySelector("body");
  const headerHeight = header.offsetHeight;

  if (window.screen.availWidth > 1365) {
    if (window.pageYOffset > headerHeight) {
      header.classList.add("fixed");
      menu.classList.add("fixed");
      body.style.paddingTop = '200px';

    } else {
      header.classList.remove("fixed");
      menu.classList.remove("fixed");
      body.style.paddingTop = '0';
    }
  }
  else {
    if (window.pageYOffset > headerHeight) {
      header.classList.add("fixed");
      menu.classList.add("fixed");


    } else {
      header.classList.remove("fixed");
      menu.classList.remove("fixed");

    }
  }
};


const switcherButton = () => {

  if (document.querySelector("#Grid1") === null) {
    return false;
  }

  const button1 = document.querySelector("#Grid1");
  const button2 = document.querySelector("#Grid2");
  const button3 = document.querySelector("#Grid3");
  const button4 = document.querySelector("#Grid4");

  const grid2 = document.querySelector(".products-list");
  const img = document.querySelectorAll(".swiper-slide > img");
  const imgBlock = document.querySelectorAll(".swiper-slide");
  const cardBlock = document.querySelectorAll(".product-card");
  const heart = document.querySelectorAll(".product-card__favorite");
  const swiper = document.querySelectorAll('.mySwiper');
  const wrapper = document.querySelectorAll('.swiper-wrapper');
  const width = window.screen.availWidth;

  button2.onclick = function() {
    button1.querySelector("svg").style.fill = '#8593a2';
    button2.querySelector("label").style.background = 'url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICAgIDxnIGlkPSJwcmVmaXhfX2ljb25fdmlld19yb3dzX2FjdGl2ZSIgZGF0YS1uYW1lPSJpY29uIHZpZXcgcm93cyBhY3RpdmUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0uMDI5IC0uMDI5KSI+CiAgICAgICAgPGcgaWQ9InByZWZpeF9fUmVjdGFuZ2xlXzE4NSIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMTg1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguMDI5IC4wMjkpIiBzdHlsZT0ic3Ryb2tlOiMwMDA7c3Ryb2tlLXdpZHRoOjNweDtmaWxsOm5vbmUiPgogICAgICAgICAgICA8cmVjdCB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHJ4PSIxIiBzdHlsZT0ic3Ryb2tlOm5vbmUiLz4KICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjE3IiBoZWlnaHQ9IjE3IiB4PSIxLjUiIHk9IjEuNSIgcng9Ii41IiBzdHlsZT0iZmlsbDpub25lIi8+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4K) center center no-repeat';
    grid2.style.gridTemplateColumns = 'repeat(1,100%)';
    img.forEach(el => {
      el.style.transform = 'scale(1)';
    });
    cardBlock.forEach(el => {
      el.classList.add('full-grid')
    });
  };
  if (width > 1365) {
    button4.onclick = function() {
      button4.querySelector("svg").style.fill = 'black';
      button3.querySelector("svg").style.fill = '#8593a2';
      grid2.style.gridTemplateColumns = 'repeat(2,38%)';
      grid2.style.justifyContent = 'center';
      cardBlock.forEach(el => {
        el.style.height = '935px';
      });
      imgBlock.forEach(el => {
        el.style.maxHeight = '836px';
      });

      heart.forEach(el => {
        el.style.transform = 'translateY(832px)';
      });

      swiper.forEach((el, i) => {

        el.addEventListener("mouseenter", (e) => {
          wrapper[i].style.transform = 'translate3d(-730px, 0px, 0px)'
        })
      });

      swiper.forEach((el, i) => {
        el.addEventListener("mouseleave", (e) => {
          wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
      });
    };
    button3.onclick = function() {
      button3.querySelector("svg").style.fill = 'black';
      button4.querySelector("svg").style.fill = '#8593a2';
      grid2.style.gridTemplateColumns = 'repeat(4,24.5%)';
      grid2.style.justifyContent = 'normal';
      cardBlock.forEach(el => {
        el.style.height = '640px';
      });
      imgBlock.forEach(el => {
        el.style.maxHeight = '560px';
      });

      heart.forEach(el => {
        el.style.transform = 'translateY(558px)';
      });

      swiper.forEach((el, i) => {

        el.addEventListener("mouseenter", (e) => {
          wrapper[i].style.transform = 'translate3d(-484px, 0px, 0px)'
        })
      });

      swiper.forEach((el, i) => {
        el.addEventListener("mouseleave", (e) => {
          wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
      });
    };
  } else {
    button4.onclick = function() {
      button4.querySelector("svg").style.fill = 'black';
      button3.querySelector("svg").style.fill = '#8593a2;';
      grid2.style.gridTemplateColumns = 'repeat(2,38%)';
      grid2.style.justifyContent = 'center';
      cardBlock.forEach(el => {
        el.style.height = '772px';
      });
      imgBlock.forEach(el => {
        el.style.maxHeight = '836px';
      });

      heart.forEach(el => {
        el.style.transform = 'translateY(678px)';
      });

      swiper.forEach((el, i) => {

        el.addEventListener("mouseenter", (e) => {
          wrapper[i].style.transform = 'translate3d(-511px, 0px, 0px)'
        })
      });

      swiper.forEach((el, i) => {
        el.addEventListener("mouseleave", (e) => {
          wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
      });
    };
    button3.onclick = function() {
      button3.querySelector("svg").style.fill = 'black';
      button4.querySelector("svg").style.fill = '#8593a2';
      grid2.style.gridTemplateColumns = 'repeat(4,24.5%)';
      grid2.style.justifyContent = 'normal';
      cardBlock.forEach(el => {
        el.style.height = '515px';
      });
      imgBlock.forEach(el => {
        el.style.maxHeight = '560px';
      });

      heart.forEach(el => {
        el.style.transform = 'none';
      });

      swiper.forEach((el, i) => {

        el.addEventListener("mouseenter", (e) => {
          wrapper[i].style.transform = 'translate3d(-344px, 0px, 0px)'
        })
      });

      swiper.forEach((el, i) => {
        el.addEventListener("mouseleave", (e) => {
          wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
      });
    };
  }
  button1.onclick = function() {
    button1.querySelector("svg").style.fill = 'black';
    button2.querySelector("label").style.background = 'url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICAgIDxkZWZzPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgLmNscy0xLC5jbHMtM3tmaWxsOm5vbmV9LmNscy0xe3N0cm9rZTojNzg4MzkxO3N0cm9rZS13aWR0aDoycHh9LmNscy0ye3N0cm9rZTpub25lfQogICAgICAgIDwvc3R5bGU+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iaWNvbl92aWV3X3Jvd3MiIGRhdGEtbmFtZT0iaWNvbiB2aWV3IHJvd3MiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0uMDI5IC0uMDI5KSI+CiAgICAgICAgPGcgaWQ9IlJlY3RhbmdsZV8xODUiIGNsYXNzPSJjbHMtMSIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMTg1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguMDI5IC4wMjkpIj4KICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiBjbGFzcz0iY2xzLTIiIHJ4PSIxIi8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xIDFoMTh2MThIMXoiIGNsYXNzPSJjbHMtMyIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==) center center no-repeat';

    grid2.style.gridTemplateColumns = 'repeat(2,50%)';
    img.forEach(el => {
      el.style.transform = 'scale(1.2)';
    });

  };
};

const burgerSubmenu = () => {
  let menuElem = document.querySelectorAll('.main-list_submenu');
  let titleElem = document.querySelectorAll('.main-list__item');


  titleElem[0].onclick = function() {
    titleElem[0].classList.toggle('item-open')
    menuElem[0].classList.toggle('open');
  };
  titleElem[1].onclick = function() {
    titleElem[1].classList.toggle('item-open')
    menuElem[1].classList.toggle('open');
  };
  titleElem[3].onclick = function() {
    titleElem[3].classList.toggle('item-open')
    menuElem[2].classList.toggle('open');
  };
  titleElem[4].onclick = function() {
    titleElem[4].classList.toggle('item-open')
    menuElem[3].classList.toggle('open');
  };

};

const searchOpen= () => {
  let form = document.querySelectorAll('.search-form');
  let btn = document.querySelector('.right-block__btn--search');
  let close = document.querySelector('.search-form__reset');

  btn.onclick = function(e) {
    e.preventDefault();
    form[0].classList.toggle('open');
    form[1].classList.toggle('open');
  };

  close.onclick = function(e) {
    e.preventDefault();
    form.classList.remove('open');
  };
};

const addressOpen = () => {
  const address = document.querySelectorAll('.second-list__link--address');

  address.forEach((el) => {
    el.addEventListener("click", (e) => {
      el.preventDefault();
    })
  });

}

const swiperPrew1 = () => {
  const swiper = document.querySelectorAll('.mySwiper');
  const wrapper = document.querySelectorAll('.swiper-wrapper');
  const width = window.screen.availWidth;

  if (width > 1365) {

    swiper.forEach((el, i) => {
      el.addEventListener("mouseenter", (e) => {
        wrapper[i].style.transform = 'translate3d(-484px, 0px, 0px)'
      })
    });

    swiper.forEach((el, i) => {
      el.addEventListener("mouseleave", (e) => {
        wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
    });
  }
  else {
    swiper.forEach((el, i) => {
      el.addEventListener("mouseenter", (e) => {
        wrapper[i].style.transform = 'translate3d(-344px, 0px, 0px)'
      })
    });

    swiper.forEach((el, i) => {
      el.addEventListener("mouseleave", (e) => {
        wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
    });
  }




};




const initFeedbackModal = () => {
  const workBtn = document.querySelector(".work__btn");
  const feedbackModal = document.querySelector("#feedback-modal");

  workBtn.addEventListener("click", () => {
    html.classList.add("lock");
    feedbackModal.classList.add("open");
  });
};

const initCloseModal = () => {
  const modalCloseButtons = document.querySelectorAll(".modal__close");

  modalCloseButtons.forEach(function (button) {
    button.addEventListener("click", () => {
      html.classList.remove("lock");
      button.closest(".modal").classList.remove("open");
    });
  });
};

const overlayClose = () => {
  const e = document.querySelector(".modal__overlay");
  e.addEventListener("click", function (event) {
    if (e == event.target) {
      html.classList.remove("lock");
      document.querySelector(".modal").classList.remove("open");
    }
  });
};



window.addEventListener("scroll", () => {
  initFixedHeader();
});

document.addEventListener(
  "DOMContentLoaded",
  function () {
    initFixedHeader();
    switcherButton();
    burgerSubmenu();
    swiperPrew1();
    searchOpen();
    addressOpen();
    catalogToogle();
  },
  false
);


const postForm = async (url, data) => {
  const res = await fetch(url, {
      method: `POST`,

      headers: {


          'Content-type': 'application/json'


      },
      body: data

  });

  return await res.json();
};

const getRes = async (url) => {
  const res = await fetch(url);

  if(!res.ok) {
      throw new Error(`Could not fetch ${url}, status ${res.status}`);
  }

  return await res.json();
};


const slider = ()=>{
  let largeSliders = document.querySelectorAll('.mySwiper')
  let prevArrow = document.querySelectorAll('.swiper-button-prev')
  let nextArrow = document.querySelectorAll('.swiper-button-next')
  largeSliders.forEach((slider, index)=>{
    let sliderLength = slider.children[0].children.length
    let result = (sliderLength > 1) ? true : false
    const swiper = new Swiper(slider, {
      enabled: true,
      slidesPerView: 1,
      spaceBetween: 40,
      navigation: {
        nextEl: nextArrow[index],
        prevEl: prevArrow[index],
      }
    });
  })
  if (window.screen.availWidth < 1365) {
    let slider = document.querySelector('.mySwiper2')
    let prevArrow = document.querySelector('.swiper-button-prev')
    let nextArrow = document.querySelector('.swiper-button-next')

    const swiper = new Swiper(slider, {
      enabled: true,
      slidesPerView: 1,
      spaceBetween: 40,
      navigation: {
        nextEl: nextArrow,
        prevEl: prevArrow,
      }
    });
  }
}



window.addEventListener('load', slider);






//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuaW1hdGlvbi5qcyIsImluZGV4LmpzIiwicG9wdXAuanMiLCJzZXJ2aWNlcy5qcyIsInN3aXBlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvVkE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJTY3JvbGxSZXZlYWwoKS5yZXZlYWwoXCIuaGVyb19fdGl0bGUgXCIsIHsgZGVsYXk6IDUwMCB9KTtcblNjcm9sbFJldmVhbCgpLnJldmVhbChcIi50ZXh0LWNvbnRlbnRcIiwgeyBkZWxheTogMTUwMCB9KTtcblxuXG5TY3JvbGxSZXZlYWwoKS5yZXZlYWwoXCIud3dkLWNhcmRcIiwge1xuICBkZWxheTogNTAwLFxuICBvcmlnaW46IFwibGVmdFwiLFxuICBkaXN0YW5jZTogXCIxMjBweFwiLFxuICBlYXNpbmc6IFwiZWFzZS1pbi1vdXRcIixcbn0pO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0ICQgPSAoeCwgcGFyZW50ID0gZG9jdW1lbnQpID0+IHtcbiAgcmV0dXJuIHBhcmVudC5xdWVyeVNlbGVjdG9yKHgpO1xufVxuXG5jb25zdCBjYXRhbG9nVG9vZ2xlID0gKCkgPT4ge1xuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5maWx0ZXJfX2l0ZW0tLWNhdGFsb2cgLm1haW4tbGlzdF9fbGluaycpLnBhcmVudE5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgJCgnLmNhdGFsb2ctbWVudSAubWVudV9fYm94JykuY2xhc3NMaXN0LnJlbW92ZSgnbWVudV9fYm94LS1oaWRlJylcbiAgJCgnLmNhdGFsb2ctbWVudSAubWVudV9fYm94JykuY2xhc3NMaXN0LmFkZCgnbWVudV9fYm94LS1vcGVuJylcbiAgfSk7XG4gICQoJy5jbG9zZS1idG4nKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICQoJy5jYXRhbG9nLW1lbnUgLm1lbnVfX2JveCcpLmNsYXNzTGlzdC5yZW1vdmUoJ21lbnVfX2JveC0tb3BlbicpXG4gICAgJCgnLmNhdGFsb2ctbWVudSAubWVudV9fYm94JykuY2xhc3NMaXN0LmFkZCgnbWVudV9fYm94LS1oaWRlJylcbiAgICB9KTtcbn1cblxuY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJodG1sXCIpO1xuXG5jb25zdCBpbml0Rml4ZWRIZWFkZXIgPSAoKSA9PiB7XG4gIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyXCIpO1xuICBjb25zdCBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51XCIpO1xuICBjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIik7XG4gIGNvbnN0IGhlYWRlckhlaWdodCA9IGhlYWRlci5vZmZzZXRIZWlnaHQ7XG5cbiAgaWYgKHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aCA+IDEzNjUpIHtcbiAgICBpZiAod2luZG93LnBhZ2VZT2Zmc2V0ID4gaGVhZGVySGVpZ2h0KSB7XG4gICAgICBoZWFkZXIuY2xhc3NMaXN0LmFkZChcImZpeGVkXCIpO1xuICAgICAgbWVudS5jbGFzc0xpc3QuYWRkKFwiZml4ZWRcIik7XG4gICAgICBib2R5LnN0eWxlLnBhZGRpbmdUb3AgPSAnMjAwcHgnO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIGhlYWRlci5jbGFzc0xpc3QucmVtb3ZlKFwiZml4ZWRcIik7XG4gICAgICBtZW51LmNsYXNzTGlzdC5yZW1vdmUoXCJmaXhlZFwiKTtcbiAgICAgIGJvZHkuc3R5bGUucGFkZGluZ1RvcCA9ICcwJztcbiAgICB9XG4gIH1cbiAgZWxzZSB7XG4gICAgaWYgKHdpbmRvdy5wYWdlWU9mZnNldCA+IGhlYWRlckhlaWdodCkge1xuICAgICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoXCJmaXhlZFwiKTtcbiAgICAgIG1lbnUuY2xhc3NMaXN0LmFkZChcImZpeGVkXCIpO1xuXG5cbiAgICB9IGVsc2Uge1xuICAgICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoXCJmaXhlZFwiKTtcbiAgICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcImZpeGVkXCIpO1xuXG4gICAgfVxuICB9XG59O1xuXG5cbmNvbnN0IHN3aXRjaGVyQnV0dG9uID0gKCkgPT4ge1xuXG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI0dyaWQxXCIpID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgYnV0dG9uMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjR3JpZDFcIik7XG4gIGNvbnN0IGJ1dHRvbjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI0dyaWQyXCIpO1xuICBjb25zdCBidXR0b24zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNHcmlkM1wiKTtcbiAgY29uc3QgYnV0dG9uNCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjR3JpZDRcIik7XG5cbiAgY29uc3QgZ3JpZDIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2R1Y3RzLWxpc3RcIik7XG4gIGNvbnN0IGltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3dpcGVyLXNsaWRlID4gaW1nXCIpO1xuICBjb25zdCBpbWdCbG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3dpcGVyLXNsaWRlXCIpO1xuICBjb25zdCBjYXJkQmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2R1Y3QtY2FyZFwiKTtcbiAgY29uc3QgaGVhcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2R1Y3QtY2FyZF9fZmF2b3JpdGVcIik7XG4gIGNvbnN0IHN3aXBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5teVN3aXBlcicpO1xuICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN3aXBlci13cmFwcGVyJyk7XG4gIGNvbnN0IHdpZHRoID0gd2luZG93LnNjcmVlbi5hdmFpbFdpZHRoO1xuXG4gIGJ1dHRvbjIub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIGJ1dHRvbjEucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJyM4NTkzYTInO1xuICAgIGJ1dHRvbjIucXVlcnlTZWxlY3RvcihcImxhYmVsXCIpLnN0eWxlLmJhY2tncm91bmQgPSAndXJsKGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeU1DSWdhR1ZwWjJoMFBTSXlNQ0lnZG1sbGQwSnZlRDBpTUNBd0lESXdJREl3SWo0S0lDQWdJRHhuSUdsa1BTSndjbVZtYVhoZlgybGpiMjVmZG1sbGQxOXliM2R6WDJGamRHbDJaU0lnWkdGMFlTMXVZVzFsUFNKcFkyOXVJSFpwWlhjZ2NtOTNjeUJoWTNScGRtVWlJSFJ5WVc1elptOXliVDBpZEhKaGJuTnNZWFJsS0MwdU1ESTVJQzB1TURJNUtTSStDaUFnSUNBZ0lDQWdQR2NnYVdROUluQnlaV1pwZUY5ZlVtVmpkR0Z1WjJ4bFh6RTROU0lnWkdGMFlTMXVZVzFsUFNKU1pXTjBZVzVuYkdVZ01UZzFJaUIwY21GdWMyWnZjbTA5SW5SeVlXNXpiR0YwWlNndU1ESTVJQzR3TWprcElpQnpkSGxzWlQwaWMzUnliMnRsT2lNd01EQTdjM1J5YjJ0bExYZHBaSFJvT2pOd2VEdG1hV3hzT201dmJtVWlQZ29nSUNBZ0lDQWdJQ0FnSUNBOGNtVmpkQ0IzYVdSMGFEMGlNakFpSUdobGFXZG9kRDBpTWpBaUlISjRQU0l4SWlCemRIbHNaVDBpYzNSeWIydGxPbTV2Ym1VaUx6NEtJQ0FnSUNBZ0lDQWdJQ0FnUEhKbFkzUWdkMmxrZEdnOUlqRTNJaUJvWldsbmFIUTlJakUzSWlCNFBTSXhMalVpSUhrOUlqRXVOU0lnY25nOUlpNDFJaUJ6ZEhsc1pUMGlabWxzYkRwdWIyNWxJaTgrQ2lBZ0lDQWdJQ0FnUEM5blBnb2dJQ0FnUEM5blBnbzhMM04yWno0SykgY2VudGVyIGNlbnRlciBuby1yZXBlYXQnO1xuICAgIGdyaWQyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSAncmVwZWF0KDEsMTAwJSknO1xuICAgIGltZy5mb3JFYWNoKGVsID0+IHtcbiAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7XG4gICAgfSk7XG4gICAgY2FyZEJsb2NrLmZvckVhY2goZWwgPT4ge1xuICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnZnVsbC1ncmlkJylcbiAgICB9KTtcbiAgfTtcbiAgaWYgKHdpZHRoID4gMTM2NSkge1xuICAgIGJ1dHRvbjQub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgYnV0dG9uNC5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnYmxhY2snO1xuICAgICAgYnV0dG9uMy5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnIzg1OTNhMic7XG4gICAgICBncmlkMi5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gJ3JlcGVhdCgyLDM4JSknO1xuICAgICAgZ3JpZDIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnY2VudGVyJztcbiAgICAgIGNhcmRCbG9jay5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gJzkzNXB4JztcbiAgICAgIH0pO1xuICAgICAgaW1nQmxvY2suZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLm1heEhlaWdodCA9ICc4MzZweCc7XG4gICAgICB9KTtcblxuICAgICAgaGVhcnQuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKDgzMnB4KSc7XG4gICAgICB9KTtcblxuICAgICAgc3dpcGVyLmZvckVhY2goKGVsLCBpKSA9PiB7XG5cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgtNzMwcHgsIDBweCwgMHB4KSdcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuXG4gICAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KScgICAgICB9KVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBidXR0b24zLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIGJ1dHRvbjMucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJ2JsYWNrJztcbiAgICAgIGJ1dHRvbjQucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJyM4NTkzYTInO1xuICAgICAgZ3JpZDIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9ICdyZXBlYXQoNCwyNC41JSknO1xuICAgICAgZ3JpZDIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnbm9ybWFsJztcbiAgICAgIGNhcmRCbG9jay5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gJzY0MHB4JztcbiAgICAgIH0pO1xuICAgICAgaW1nQmxvY2suZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLm1heEhlaWdodCA9ICc1NjBweCc7XG4gICAgICB9KTtcblxuICAgICAgaGVhcnQuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKDU1OHB4KSc7XG4gICAgICB9KTtcblxuICAgICAgc3dpcGVyLmZvckVhY2goKGVsLCBpKSA9PiB7XG5cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgtNDg0cHgsIDBweCwgMHB4KSdcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuXG4gICAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KScgICAgICB9KVxuICAgICAgfSk7XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBidXR0b240Lm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIGJ1dHRvbjQucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJ2JsYWNrJztcbiAgICAgIGJ1dHRvbjMucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJyM4NTkzYTI7JztcbiAgICAgIGdyaWQyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSAncmVwZWF0KDIsMzglKSc7XG4gICAgICBncmlkMi5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdjZW50ZXInO1xuICAgICAgY2FyZEJsb2NrLmZvckVhY2goZWwgPT4ge1xuICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSAnNzcycHgnO1xuICAgICAgfSk7XG4gICAgICBpbWdCbG9jay5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUubWF4SGVpZ2h0ID0gJzgzNnB4JztcbiAgICAgIH0pO1xuXG4gICAgICBoZWFydC5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVkoNjc4cHgpJztcbiAgICAgIH0pO1xuXG4gICAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcblxuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoZSkgPT4ge1xuICAgICAgICAgIHdyYXBwZXJbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKC01MTFweCwgMHB4LCAwcHgpJ1xuICAgICAgICB9KVxuICAgICAgfSk7XG5cbiAgICAgIHN3aXBlci5mb3JFYWNoKChlbCwgaSkgPT4ge1xuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCAoZSkgPT4ge1xuICAgICAgICAgIHdyYXBwZXJbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKDBweCwgMHB4LCAwcHgpJyAgICAgIH0pXG4gICAgICB9KTtcbiAgICB9O1xuICAgIGJ1dHRvbjMub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgYnV0dG9uMy5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnYmxhY2snO1xuICAgICAgYnV0dG9uNC5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnIzg1OTNhMic7XG4gICAgICBncmlkMi5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gJ3JlcGVhdCg0LDI0LjUlKSc7XG4gICAgICBncmlkMi5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdub3JtYWwnO1xuICAgICAgY2FyZEJsb2NrLmZvckVhY2goZWwgPT4ge1xuICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSAnNTE1cHgnO1xuICAgICAgfSk7XG4gICAgICBpbWdCbG9jay5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUubWF4SGVpZ2h0ID0gJzU2MHB4JztcbiAgICAgIH0pO1xuXG4gICAgICBoZWFydC5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUudHJhbnNmb3JtID0gJ25vbmUnO1xuICAgICAgfSk7XG5cbiAgICAgIHN3aXBlci5mb3JFYWNoKChlbCwgaSkgPT4ge1xuXG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIChlKSA9PiB7XG4gICAgICAgICAgd3JhcHBlcltpXS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoLTM0NHB4LCAwcHgsIDBweCknXG4gICAgICAgIH0pXG4gICAgICB9KTtcblxuICAgICAgc3dpcGVyLmZvckVhY2goKGVsLCBpKSA9PiB7XG4gICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIChlKSA9PiB7XG4gICAgICAgICAgd3JhcHBlcltpXS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoMHB4LCAwcHgsIDBweCknICAgICAgfSlcbiAgICAgIH0pO1xuICAgIH07XG4gIH1cbiAgYnV0dG9uMS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgYnV0dG9uMS5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnYmxhY2snO1xuICAgIGJ1dHRvbjIucXVlcnlTZWxlY3RvcihcImxhYmVsXCIpLnN0eWxlLmJhY2tncm91bmQgPSAndXJsKGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeU1DSWdhR1ZwWjJoMFBTSXlNQ0lnZG1sbGQwSnZlRDBpTUNBd0lESXdJREl3SWo0S0lDQWdJRHhrWldaelBnb2dJQ0FnSUNBZ0lEeHpkSGxzWlQ0S0lDQWdJQ0FnSUNBZ0lDQWdMbU5zY3kweExDNWpiSE10TTN0bWFXeHNPbTV2Ym1WOUxtTnNjeTB4ZTNOMGNtOXJaVG9qTnpnNE16a3hPM04wY205clpTMTNhV1IwYURveWNIaDlMbU5zY3kweWUzTjBjbTlyWlRwdWIyNWxmUW9nSUNBZ0lDQWdJRHd2YzNSNWJHVStDaUFnSUNBOEwyUmxabk0rQ2lBZ0lDQThaeUJwWkQwaWFXTnZibDkyYVdWM1gzSnZkM01pSUdSaGRHRXRibUZ0WlQwaWFXTnZiaUIyYVdWM0lISnZkM01pSUhSeVlXNXpabTl5YlQwaWRISmhibk5zWVhSbEtDMHVNREk1SUMwdU1ESTVLU0krQ2lBZ0lDQWdJQ0FnUEdjZ2FXUTlJbEpsWTNSaGJtZHNaVjh4T0RVaUlHTnNZWE56UFNKamJITXRNU0lnWkdGMFlTMXVZVzFsUFNKU1pXTjBZVzVuYkdVZ01UZzFJaUIwY21GdWMyWnZjbTA5SW5SeVlXNXpiR0YwWlNndU1ESTVJQzR3TWprcElqNEtJQ0FnSUNBZ0lDQWdJQ0FnUEhKbFkzUWdkMmxrZEdnOUlqSXdJaUJvWldsbmFIUTlJakl3SWlCamJHRnpjejBpWTJ4ekxUSWlJSEo0UFNJeElpOCtDaUFnSUNBZ0lDQWdJQ0FnSUR4d1lYUm9JR1E5SWsweElERm9NVGgyTVRoSU1Yb2lJR05zWVhOelBTSmpiSE10TXlJdlBnb2dJQ0FnSUNBZ0lEd3ZaejRLSUNBZ0lEd3ZaejRLUEM5emRtYytDZz09KSBjZW50ZXIgY2VudGVyIG5vLXJlcGVhdCc7XG5cbiAgICBncmlkMi5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gJ3JlcGVhdCgyLDUwJSknO1xuICAgIGltZy5mb3JFYWNoKGVsID0+IHtcbiAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxLjIpJztcbiAgICB9KTtcblxuICB9O1xufTtcblxuY29uc3QgYnVyZ2VyU3VibWVudSA9ICgpID0+IHtcbiAgbGV0IG1lbnVFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1haW4tbGlzdF9zdWJtZW51Jyk7XG4gIGxldCB0aXRsZUVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWFpbi1saXN0X19pdGVtJyk7XG5cblxuICB0aXRsZUVsZW1bMF0ub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIHRpdGxlRWxlbVswXS5jbGFzc0xpc3QudG9nZ2xlKCdpdGVtLW9wZW4nKVxuICAgIG1lbnVFbGVtWzBdLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgfTtcbiAgdGl0bGVFbGVtWzFdLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aXRsZUVsZW1bMV0uY2xhc3NMaXN0LnRvZ2dsZSgnaXRlbS1vcGVuJylcbiAgICBtZW51RWxlbVsxXS5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuJyk7XG4gIH07XG4gIHRpdGxlRWxlbVszXS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgdGl0bGVFbGVtWzNdLmNsYXNzTGlzdC50b2dnbGUoJ2l0ZW0tb3BlbicpXG4gICAgbWVudUVsZW1bMl0uY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICB9O1xuICB0aXRsZUVsZW1bNF0ub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIHRpdGxlRWxlbVs0XS5jbGFzc0xpc3QudG9nZ2xlKCdpdGVtLW9wZW4nKVxuICAgIG1lbnVFbGVtWzNdLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgfTtcblxufTtcblxuY29uc3Qgc2VhcmNoT3Blbj0gKCkgPT4ge1xuICBsZXQgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWFyY2gtZm9ybScpO1xuICBsZXQgYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJpZ2h0LWJsb2NrX19idG4tLXNlYXJjaCcpO1xuICBsZXQgY2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VhcmNoLWZvcm1fX3Jlc2V0Jyk7XG5cbiAgYnRuLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGZvcm1bMF0uY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICAgIGZvcm1bMV0uY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICB9O1xuXG4gIGNsb3NlLm9uY2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGZvcm0uY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpO1xuICB9O1xufTtcblxuY29uc3QgYWRkcmVzc09wZW4gPSAoKSA9PiB7XG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2Vjb25kLWxpc3RfX2xpbmstLWFkZHJlc3MnKTtcblxuICBhZGRyZXNzLmZvckVhY2goKGVsKSA9PiB7XG4gICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBlbC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pXG4gIH0pO1xuXG59XG5cbmNvbnN0IHN3aXBlclByZXcxID0gKCkgPT4ge1xuICBjb25zdCBzd2lwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubXlTd2lwZXInKTtcbiAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zd2lwZXItd3JhcHBlcicpO1xuICBjb25zdCB3aWR0aCA9IHdpbmRvdy5zY3JlZW4uYXZhaWxXaWR0aDtcblxuICBpZiAod2lkdGggPiAxMzY1KSB7XG5cbiAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIChlKSA9PiB7XG4gICAgICAgIHdyYXBwZXJbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKC00ODRweCwgMHB4LCAwcHgpJ1xuICAgICAgfSlcbiAgICB9KTtcblxuICAgIHN3aXBlci5mb3JFYWNoKChlbCwgaSkgPT4ge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKGUpID0+IHtcbiAgICAgICAgd3JhcHBlcltpXS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoMHB4LCAwcHgsIDBweCknICAgICAgfSlcbiAgICB9KTtcbiAgfVxuICBlbHNlIHtcbiAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIChlKSA9PiB7XG4gICAgICAgIHdyYXBwZXJbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKC0zNDRweCwgMHB4LCAwcHgpJ1xuICAgICAgfSlcbiAgICB9KTtcblxuICAgIHN3aXBlci5mb3JFYWNoKChlbCwgaSkgPT4ge1xuICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKGUpID0+IHtcbiAgICAgICAgd3JhcHBlcltpXS5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoMHB4LCAwcHgsIDBweCknICAgICAgfSlcbiAgICB9KTtcbiAgfVxuXG5cblxuXG59O1xuXG5cblxuXG5jb25zdCBpbml0RmVlZGJhY2tNb2RhbCA9ICgpID0+IHtcbiAgY29uc3Qgd29ya0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud29ya19fYnRuXCIpO1xuICBjb25zdCBmZWVkYmFja01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmZWVkYmFjay1tb2RhbFwiKTtcblxuICB3b3JrQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgaHRtbC5jbGFzc0xpc3QuYWRkKFwibG9ja1wiKTtcbiAgICBmZWVkYmFja01vZGFsLmNsYXNzTGlzdC5hZGQoXCJvcGVuXCIpO1xuICB9KTtcbn07XG5cbmNvbnN0IGluaXRDbG9zZU1vZGFsID0gKCkgPT4ge1xuICBjb25zdCBtb2RhbENsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlXCIpO1xuXG4gIG1vZGFsQ2xvc2VCdXR0b25zLmZvckVhY2goZnVuY3Rpb24gKGJ1dHRvbikge1xuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgaHRtbC5jbGFzc0xpc3QucmVtb3ZlKFwibG9ja1wiKTtcbiAgICAgIGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmNvbnN0IG92ZXJsYXlDbG9zZSA9ICgpID0+IHtcbiAgY29uc3QgZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX292ZXJsYXlcIik7XG4gIGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIGlmIChlID09IGV2ZW50LnRhcmdldCkge1xuICAgICAgaHRtbC5jbGFzc0xpc3QucmVtb3ZlKFwibG9ja1wiKTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxcIikuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG4gICAgfVxuICB9KTtcbn07XG5cblxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCAoKSA9PiB7XG4gIGluaXRGaXhlZEhlYWRlcigpO1xufSk7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gIFwiRE9NQ29udGVudExvYWRlZFwiLFxuICBmdW5jdGlvbiAoKSB7XG4gICAgaW5pdEZpeGVkSGVhZGVyKCk7XG4gICAgc3dpdGNoZXJCdXR0b24oKTtcbiAgICBidXJnZXJTdWJtZW51KCk7XG4gICAgc3dpcGVyUHJldzEoKTtcbiAgICBzZWFyY2hPcGVuKCk7XG4gICAgYWRkcmVzc09wZW4oKTtcbiAgICBjYXRhbG9nVG9vZ2xlKCk7XG4gIH0sXG4gIGZhbHNlXG4pO1xuIiwiIiwiY29uc3QgcG9zdEZvcm0gPSBhc3luYyAodXJsLCBkYXRhKSA9PiB7XG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgbWV0aG9kOiBgUE9TVGAsXG5cbiAgICAgIGhlYWRlcnM6IHtcblxuXG4gICAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuXG5cbiAgICAgIH0sXG4gICAgICBib2R5OiBkYXRhXG5cbiAgfSk7XG5cbiAgcmV0dXJuIGF3YWl0IHJlcy5qc29uKCk7XG59O1xuXG5jb25zdCBnZXRSZXMgPSBhc3luYyAodXJsKSA9PiB7XG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCk7XG5cbiAgaWYoIXJlcy5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmV0Y2ggJHt1cmx9LCBzdGF0dXMgJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgcmV0dXJuIGF3YWl0IHJlcy5qc29uKCk7XG59O1xuIiwiXG5jb25zdCBzbGlkZXIgPSAoKT0+e1xuICBsZXQgbGFyZ2VTbGlkZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm15U3dpcGVyJylcbiAgbGV0IHByZXZBcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zd2lwZXItYnV0dG9uLXByZXYnKVxuICBsZXQgbmV4dEFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN3aXBlci1idXR0b24tbmV4dCcpXG4gIGxhcmdlU2xpZGVycy5mb3JFYWNoKChzbGlkZXIsIGluZGV4KT0+e1xuICAgIGxldCBzbGlkZXJMZW5ndGggPSBzbGlkZXIuY2hpbGRyZW5bMF0uY2hpbGRyZW4ubGVuZ3RoXG4gICAgbGV0IHJlc3VsdCA9IChzbGlkZXJMZW5ndGggPiAxKSA/IHRydWUgOiBmYWxzZVxuICAgIGNvbnN0IHN3aXBlciA9IG5ldyBTd2lwZXIoc2xpZGVyLCB7XG4gICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICAgIHNwYWNlQmV0d2VlbjogNDAsXG4gICAgICBuYXZpZ2F0aW9uOiB7XG4gICAgICAgIG5leHRFbDogbmV4dEFycm93W2luZGV4XSxcbiAgICAgICAgcHJldkVsOiBwcmV2QXJyb3dbaW5kZXhdLFxuICAgICAgfVxuICAgIH0pO1xuICB9KVxuICBpZiAod2luZG93LnNjcmVlbi5hdmFpbFdpZHRoIDwgMTM2NSkge1xuICAgIGxldCBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXlTd2lwZXIyJylcbiAgICBsZXQgcHJldkFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN3aXBlci1idXR0b24tcHJldicpXG4gICAgbGV0IG5leHRBcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zd2lwZXItYnV0dG9uLW5leHQnKVxuXG4gICAgY29uc3Qgc3dpcGVyID0gbmV3IFN3aXBlcihzbGlkZXIsIHtcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICBzbGlkZXNQZXJWaWV3OiAxLFxuICAgICAgc3BhY2VCZXR3ZWVuOiA0MCxcbiAgICAgIG5hdmlnYXRpb246IHtcbiAgICAgICAgbmV4dEVsOiBuZXh0QXJyb3csXG4gICAgICAgIHByZXZFbDogcHJldkFycm93LFxuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cblxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHNsaWRlcik7XG5cblxuXG5cblxuIl19
