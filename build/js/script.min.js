ScrollReveal().reveal(".hero__title ", { delay: 500 });
ScrollReveal().reveal(".text-content", { delay: 1500 });


ScrollReveal().reveal(".wwd-card", {
  delay: 500,
  origin: "left",
  distance: "120px",
  easing: "ease-in-out",
});

"use strict";

const $ = (x, parent = document) => {
  return parent.querySelector(x);
}

const catalogToogle = () => {
  if (document.querySelector(".catalog-menu .menu__box") === null) {
    return false;
  }
 document.querySelector('.filter__item--catalog .main-list__link').parentNode.addEventListener("click", () => {
  $('.catalog-menu .menu__box').classList.toggle('menu__box--open')
  });
  $('.close-btn').addEventListener("click", () => {
    $('.catalog-menu .menu__box').classList.toggle('menu__box--open')
    });
  document.querySelector('#catalog-btn').addEventListener("click", () => {
    $('.catalog-menu .menu__box').classList.toggle('menu__box--open')
  });
}

const html = document.querySelector("html");

const popupInit = () => {
  const sliders = document.querySelectorAll(".details .mySwiper2 .swiper-slide img");
    function Resize () {
      if (window.screen.availWidth > 1365) {
        sliders.forEach(el => {
          el.setAttribute ('data-fancybox', 'gallery')
        });
      }
    else {
      sliders.forEach(el => {
        el.removeAttribute ('data-fancybox', 'gallery')
      });
    }
  }
  Resize();
  window.addEventListener(`resize`, e => {
        Resize();
  });
  };



const initFixedHeader = () => {
  const header = document.querySelector(".header");
  const menu = document.querySelector(".menu");
  const body = document.querySelector("body");
  const catalog = document.querySelector(".catalog-menu .menu__box");
  const headerHeight = header.offsetHeight;

  if (window.screen.availWidth > 1365) {
    if (window.pageYOffset > headerHeight) {
      header.classList.add("fixed");
      menu.classList.add("fixed");
      body.style.paddingTop = '200px';

    } else {
      header.classList.remove("fixed");
      menu.classList.remove("fixed");
      body.style.paddingTop = '0';
    }
  }
  else {
    if (window.pageYOffset > headerHeight) {
      header.classList.add("fixed");
      menu.classList.add("fixed");
    } else {
      header.classList.remove("fixed");
      menu.classList.remove("fixed");
    }
  }
};

const initFixedMenu = () => {

  if (document.querySelector(".catalog-menu .menu__box") === null) {
    return false;
  }
  const header = document.querySelector(".header");
  const catalog = document.querySelector(".catalog-menu .menu__box");
  const body = document.querySelector("body");
  const headerHeight = header.offsetHeight;

  if (window.screen.availWidth > 1365) {
    catalog.classList.add("fixed");
  }
  else {
    catalog.classList.remove("fixed");
  }
}

const switcherButton = () => {

  if (document.querySelector("#Grid3") === null) {
    return false;
  }

  const button1 = document.querySelector("#Grid1");
  const button2 = document.querySelector("#Grid2");
  const button3 = document.querySelector("#Grid3");
  const button4 = document.querySelector("#Grid4");

  const grid2 = document.querySelector(".products-list");
  const img = document.querySelectorAll(".swiper-slide > img");
  const imgBlock = document.querySelectorAll(".swiper-slide");
  const cardBlock = document.querySelectorAll(".product-card");
  const heart = document.querySelectorAll(".product-card__favorite");
  const swiper = document.querySelectorAll('.mySwiper');
  const wrapper = document.querySelectorAll('.swiper-wrapper');
  const width = window.screen.availWidth;

  button2.onclick = function() {
    button1.querySelector("svg").style.fill = '#8593a2';
    button2.querySelector("label").style.background = 'url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICAgIDxnIGlkPSJwcmVmaXhfX2ljb25fdmlld19yb3dzX2FjdGl2ZSIgZGF0YS1uYW1lPSJpY29uIHZpZXcgcm93cyBhY3RpdmUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0uMDI5IC0uMDI5KSI+CiAgICAgICAgPGcgaWQ9InByZWZpeF9fUmVjdGFuZ2xlXzE4NSIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMTg1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguMDI5IC4wMjkpIiBzdHlsZT0ic3Ryb2tlOiMwMDA7c3Ryb2tlLXdpZHRoOjNweDtmaWxsOm5vbmUiPgogICAgICAgICAgICA8cmVjdCB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHJ4PSIxIiBzdHlsZT0ic3Ryb2tlOm5vbmUiLz4KICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjE3IiBoZWlnaHQ9IjE3IiB4PSIxLjUiIHk9IjEuNSIgcng9Ii41IiBzdHlsZT0iZmlsbDpub25lIi8+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4K) center center no-repeat';
    grid2.style.gridTemplateColumns = 'repeat(1,100%)';
    img.forEach(el => {
      el.style.transform = 'scale(1)';
    });
    cardBlock.forEach(el => {
      el.classList.add('full-grid')
    });
  };
  if (width > 1440) {
    button4.onclick = function() {
      button4.querySelector("svg").style.fill = 'black';
      button3.querySelector("svg").style.fill = '#8593a2';
      grid2.style.gridTemplateColumns = 'repeat(2,38%)';
      grid2.style.justifyContent = 'center';
      cardBlock.forEach(el => {
        el.style.height = '935px';
      });
      imgBlock.forEach(el => {
        el.style.maxHeight = '836px';
      });

      heart.forEach(el => {
        el.style.transform = 'translateY(832px)';
      });

      swiper.forEach((el, i) => {

        el.addEventListener("mouseenter", (e) => {
          wrapper[i].style.transform = 'translate3d(-730px, 0px, 0px)'
        })
      });

      swiper.forEach((el, i) => {
        el.addEventListener("mouseleave", (e) => {
          wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
      });
    };
    button3.onclick = function() {
      button3.querySelector("svg").style.fill = 'black';
      button4.querySelector("svg").style.fill = '#8593a2';
      grid2.style.gridTemplateColumns = 'repeat(4,24.5%)';
      grid2.style.justifyContent = 'normal';
      cardBlock.forEach(el => {
        el.style.height = '640px';
      });
      imgBlock.forEach(el => {
        el.style.maxHeight = '560px';
      });

      heart.forEach(el => {
        el.style.transform = 'translateY(558px)';
      });

      swiper.forEach((el, i) => {

        el.addEventListener("mouseenter", (e) => {
          wrapper[i].style.transform = 'translate3d(-484px, 0px, 0px)'
        })
      });

      swiper.forEach((el, i) => {
        el.addEventListener("mouseleave", (e) => {
          wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
      });
    };
  } else {

    button4.onclick = function() {
      button4.querySelector("svg").style.fill = 'black';
      button3.querySelector("svg").style.fill = '#8593a2;';
      grid2.style.gridTemplateColumns = 'repeat(2,38%)';
      grid2.style.justifyContent = 'center';
      cardBlock.forEach(el => {
        el.style.height = '772px';
      });
      imgBlock.forEach(el => {
        el.style.maxHeight = '836px';
      });

      heart.forEach(el => {
        el.style.transform = 'translateY(0)';
      });

      swiper.forEach((el, i) => {

        el.addEventListener("mouseenter", (e) => {
          wrapper[i].style.transform = 'translate3d(-511px, 0px, 0px)'
        })
      });

      swiper.forEach((el, i) => {
        el.addEventListener("mouseleave", (e) => {
          wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
      });
    };
    button3.onclick = function() {
      button3.querySelector("svg").style.fill = 'black';
      button4.querySelector("svg").style.fill = '#8593a2';
      grid2.style.gridTemplateColumns = 'repeat(4,24.5%)';
      grid2.style.justifyContent = 'normal';
      cardBlock.forEach(el => {
        el.style.height = '515px';
      });
      imgBlock.forEach(el => {
        el.style.maxHeight = '560px';
      });

      heart.forEach(el => {
        el.style.transform = 'none';
      });

      swiper.forEach((el, i) => {

        el.addEventListener("mouseenter", (e) => {
          wrapper[i].style.transform = 'translate3d(-344px, 0px, 0px)'
        })
      });

      swiper.forEach((el, i) => {
        el.addEventListener("mouseleave", (e) => {
          wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
      });
    };
  }
  button1.onclick = function() {
    button1.querySelector("svg").style.fill = 'black';
    button2.querySelector("label").style.background = 'url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdmlld0JveD0iMCAwIDIwIDIwIj4KICAgIDxkZWZzPgogICAgICAgIDxzdHlsZT4KICAgICAgICAgICAgLmNscy0xLC5jbHMtM3tmaWxsOm5vbmV9LmNscy0xe3N0cm9rZTojNzg4MzkxO3N0cm9rZS13aWR0aDoycHh9LmNscy0ye3N0cm9rZTpub25lfQogICAgICAgIDwvc3R5bGU+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iaWNvbl92aWV3X3Jvd3MiIGRhdGEtbmFtZT0iaWNvbiB2aWV3IHJvd3MiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0uMDI5IC0uMDI5KSI+CiAgICAgICAgPGcgaWQ9IlJlY3RhbmdsZV8xODUiIGNsYXNzPSJjbHMtMSIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMTg1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSguMDI5IC4wMjkpIj4KICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiBjbGFzcz0iY2xzLTIiIHJ4PSIxIi8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xIDFoMTh2MThIMXoiIGNsYXNzPSJjbHMtMyIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==) center center no-repeat';

    grid2.style.gridTemplateColumns = 'repeat(2,50%)';
    img.forEach(el => {
      el.style.transform = 'scale(1.2)';
    });

  };
};

const burgerSubmenu = () => {
  let menuElem = document.querySelectorAll('.main-list_submenu');
  let titleElem = document.querySelectorAll('.main-list__item');


  titleElem[0].onclick = function() {
    titleElem[0].classList.toggle('item-open')
    menuElem[0].classList.toggle('open');
  };
  titleElem[1].onclick = function() {
    titleElem[1].classList.toggle('item-open')
    menuElem[1].classList.toggle('open');
  };
  titleElem[3].onclick = function() {
    titleElem[3].classList.toggle('item-open')
    menuElem[2].classList.toggle('open');
  };
  titleElem[4].onclick = function() {
    titleElem[4].classList.toggle('item-open')
    menuElem[3].classList.toggle('open');
  };

};

const searchOpen= () => {
  let form = document.querySelectorAll('.search-form');
  let btn = document.querySelector('.right-block__btn--search');
  let close = document.querySelector('.search-form__reset');

  btn.onclick = function(e) {
    e.preventDefault();
    form[0].classList.toggle('open');
    form[1].classList.toggle('open');
  };

  close.onclick = function(e) {
    e.preventDefault();
    form.classList.remove('open');
  };
};

const addressOpen = () => {
  const address = document.querySelectorAll('.second-list__link--address');

  address.forEach((el) => {
    el.addEventListener("click", (e) => {
      el.preventDefault();
    })
  });

}

const swiperPrew1 = () => {
  const swiper = document.querySelectorAll('.mySwiper');
  const wrapper = document.querySelectorAll('.swiper-wrapper');
  const width = window.screen.availWidth;

  if (width > 1440) {

    swiper.forEach((el, i) => {
      el.addEventListener("mouseenter", (e) => {
        wrapper[i].style.transform = 'translate3d(-484px, 0px, 0px)'
      })
    });

    swiper.forEach((el, i) => {
      el.addEventListener("mouseleave", (e) => {
        wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
    });
  }
  else {
    swiper.forEach((el, i) => {
      el.addEventListener("mouseenter", (e) => {
        wrapper[i].style.transform = 'translate3d(-344px, 0px, 0px)'
      })
    });

    swiper.forEach((el, i) => {
      el.addEventListener("mouseleave", (e) => {
        wrapper[i].style.transform = 'translate3d(0px, 0px, 0px)'      })
    });
  }




};




const initFeedbackModal = () => {
  const workBtn = document.querySelector(".work__btn");
  const feedbackModal = document.querySelector("#feedback-modal");

  workBtn.addEventListener("click", () => {
    html.classList.add("lock");
    feedbackModal.classList.add("open");
  });
};

const initCloseModal = () => {
  const modalCloseButtons = document.querySelectorAll(".modal__close");

  modalCloseButtons.forEach(function (button) {
    button.addEventListener("click", () => {
      html.classList.remove("lock");
      button.closest(".modal").classList.remove("open");
    });
  });
};

const overlayClose = () => {
  const e = document.querySelector(".modal__overlay");
  e.addEventListener("click", function (event) {
    if (e == event.target) {
      html.classList.remove("lock");
      document.querySelector(".modal").classList.remove("open");
    }
  });
};



window.addEventListener("scroll", () => {
  initFixedHeader();
});

document.addEventListener(
  "DOMContentLoaded",
  function () {
    initFixedHeader();
    switcherButton();
    burgerSubmenu();
    swiperPrew1();
    searchOpen();
    addressOpen();
    catalogToogle();
    popupInit();
    initFixedMenu();
  },
  false
);


const postForm = async (url, data) => {
  const res = await fetch(url, {
      method: `POST`,

      headers: {


          'Content-type': 'application/json'


      },
      body: data

  });

  return await res.json();
};

const getRes = async (url) => {
  const res = await fetch(url);

  if(!res.ok) {
      throw new Error(`Could not fetch ${url}, status ${res.status}`);
  }

  return await res.json();
};


const slider = ()=>{
  let largeSliders = document.querySelectorAll('.mySwiper')
  let prevArrow = document.querySelectorAll('.swiper-button-prev')
  let nextArrow = document.querySelectorAll('.swiper-button-next')
  largeSliders.forEach((slider, index)=>{
    let sliderLength = slider.children[0].children.length
    let result = (sliderLength > 1) ? true : false
    const swiper = new Swiper(slider, {
      enabled: true,
      slidesPerView: 1,
      spaceBetween: 40,
      navigation: {
        nextEl: nextArrow[index],
        prevEl: prevArrow[index],
      }
    });
  })
  if (window.screen.availWidth < 1365) {
    let slider = document.querySelector('.mySwiper2')
    let prevArrow = document.querySelector('.swiper-button-prev')
    let nextArrow = document.querySelector('.swiper-button-next')

    const swiper = new Swiper(slider, {
      enabled: true,
      slidesPerView: 1,
      spaceBetween: 40,
      navigation: {
        nextEl: nextArrow,
        prevEl: prevArrow,
      }
    });
  }
}



window.addEventListener('load', slider);






//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuaW1hdGlvbi5qcyIsImluZGV4LmpzIiwicG9wdXAuanMiLCJzZXJ2aWNlcy5qcyIsInN3aXBlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM1lBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiU2Nyb2xsUmV2ZWFsKCkucmV2ZWFsKFwiLmhlcm9fX3RpdGxlIFwiLCB7IGRlbGF5OiA1MDAgfSk7XG5TY3JvbGxSZXZlYWwoKS5yZXZlYWwoXCIudGV4dC1jb250ZW50XCIsIHsgZGVsYXk6IDE1MDAgfSk7XG5cblxuU2Nyb2xsUmV2ZWFsKCkucmV2ZWFsKFwiLnd3ZC1jYXJkXCIsIHtcbiAgZGVsYXk6IDUwMCxcbiAgb3JpZ2luOiBcImxlZnRcIixcbiAgZGlzdGFuY2U6IFwiMTIwcHhcIixcbiAgZWFzaW5nOiBcImVhc2UtaW4tb3V0XCIsXG59KTtcbiIsIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCAkID0gKHgsIHBhcmVudCA9IGRvY3VtZW50KSA9PiB7XG4gIHJldHVybiBwYXJlbnQucXVlcnlTZWxlY3Rvcih4KTtcbn1cblxuY29uc3QgY2F0YWxvZ1Rvb2dsZSA9ICgpID0+IHtcbiAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2F0YWxvZy1tZW51IC5tZW51X19ib3hcIikgPT09IG51bGwpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZmlsdGVyX19pdGVtLS1jYXRhbG9nIC5tYWluLWxpc3RfX2xpbmsnKS5wYXJlbnROb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICQoJy5jYXRhbG9nLW1lbnUgLm1lbnVfX2JveCcpLmNsYXNzTGlzdC50b2dnbGUoJ21lbnVfX2JveC0tb3BlbicpXG4gIH0pO1xuICAkKCcuY2xvc2UtYnRuJykuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAkKCcuY2F0YWxvZy1tZW51IC5tZW51X19ib3gnKS5jbGFzc0xpc3QudG9nZ2xlKCdtZW51X19ib3gtLW9wZW4nKVxuICAgIH0pO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2F0YWxvZy1idG4nKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICQoJy5jYXRhbG9nLW1lbnUgLm1lbnVfX2JveCcpLmNsYXNzTGlzdC50b2dnbGUoJ21lbnVfX2JveC0tb3BlbicpXG4gIH0pO1xufVxuXG5jb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImh0bWxcIik7XG5cbmNvbnN0IHBvcHVwSW5pdCA9ICgpID0+IHtcbiAgY29uc3Qgc2xpZGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZGV0YWlscyAubXlTd2lwZXIyIC5zd2lwZXItc2xpZGUgaW1nXCIpO1xuICAgIGZ1bmN0aW9uIFJlc2l6ZSAoKSB7XG4gICAgICBpZiAod2luZG93LnNjcmVlbi5hdmFpbFdpZHRoID4gMTM2NSkge1xuICAgICAgICBzbGlkZXJzLmZvckVhY2goZWwgPT4ge1xuICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSAoJ2RhdGEtZmFuY3lib3gnLCAnZ2FsbGVyeScpXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIGVsc2Uge1xuICAgICAgc2xpZGVycy5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlICgnZGF0YS1mYW5jeWJveCcsICdnYWxsZXJ5JylcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBSZXNpemUoKTtcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYHJlc2l6ZWAsIGUgPT4ge1xuICAgICAgICBSZXNpemUoKTtcbiAgfSk7XG4gIH07XG5cblxuXG5jb25zdCBpbml0Rml4ZWRIZWFkZXIgPSAoKSA9PiB7XG4gIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyXCIpO1xuICBjb25zdCBtZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51XCIpO1xuICBjb25zdCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIik7XG4gIGNvbnN0IGNhdGFsb2cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhdGFsb2ctbWVudSAubWVudV9fYm94XCIpO1xuICBjb25zdCBoZWFkZXJIZWlnaHQgPSBoZWFkZXIub2Zmc2V0SGVpZ2h0O1xuXG4gIGlmICh3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGggPiAxMzY1KSB7XG4gICAgaWYgKHdpbmRvdy5wYWdlWU9mZnNldCA+IGhlYWRlckhlaWdodCkge1xuICAgICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoXCJmaXhlZFwiKTtcbiAgICAgIG1lbnUuY2xhc3NMaXN0LmFkZChcImZpeGVkXCIpO1xuICAgICAgYm9keS5zdHlsZS5wYWRkaW5nVG9wID0gJzIwMHB4JztcblxuICAgIH0gZWxzZSB7XG4gICAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZShcImZpeGVkXCIpO1xuICAgICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKFwiZml4ZWRcIik7XG4gICAgICBib2R5LnN0eWxlLnBhZGRpbmdUb3AgPSAnMCc7XG4gICAgfVxuICB9XG4gIGVsc2Uge1xuICAgIGlmICh3aW5kb3cucGFnZVlPZmZzZXQgPiBoZWFkZXJIZWlnaHQpIHtcbiAgICAgIGhlYWRlci5jbGFzc0xpc3QuYWRkKFwiZml4ZWRcIik7XG4gICAgICBtZW51LmNsYXNzTGlzdC5hZGQoXCJmaXhlZFwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoXCJmaXhlZFwiKTtcbiAgICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZShcImZpeGVkXCIpO1xuICAgIH1cbiAgfVxufTtcblxuY29uc3QgaW5pdEZpeGVkTWVudSA9ICgpID0+IHtcblxuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXRhbG9nLW1lbnUgLm1lbnVfX2JveFwiKSA9PT0gbnVsbCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlclwiKTtcbiAgY29uc3QgY2F0YWxvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2F0YWxvZy1tZW51IC5tZW51X19ib3hcIik7XG4gIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKTtcbiAgY29uc3QgaGVhZGVySGVpZ2h0ID0gaGVhZGVyLm9mZnNldEhlaWdodDtcblxuICBpZiAod2luZG93LnNjcmVlbi5hdmFpbFdpZHRoID4gMTM2NSkge1xuICAgIGNhdGFsb2cuY2xhc3NMaXN0LmFkZChcImZpeGVkXCIpO1xuICB9XG4gIGVsc2Uge1xuICAgIGNhdGFsb2cuY2xhc3NMaXN0LnJlbW92ZShcImZpeGVkXCIpO1xuICB9XG59XG5cbmNvbnN0IHN3aXRjaGVyQnV0dG9uID0gKCkgPT4ge1xuXG4gIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI0dyaWQzXCIpID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgYnV0dG9uMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjR3JpZDFcIik7XG4gIGNvbnN0IGJ1dHRvbjIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI0dyaWQyXCIpO1xuICBjb25zdCBidXR0b24zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNHcmlkM1wiKTtcbiAgY29uc3QgYnV0dG9uNCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjR3JpZDRcIik7XG5cbiAgY29uc3QgZ3JpZDIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2R1Y3RzLWxpc3RcIik7XG4gIGNvbnN0IGltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3dpcGVyLXNsaWRlID4gaW1nXCIpO1xuICBjb25zdCBpbWdCbG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc3dpcGVyLXNsaWRlXCIpO1xuICBjb25zdCBjYXJkQmxvY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2R1Y3QtY2FyZFwiKTtcbiAgY29uc3QgaGVhcnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2R1Y3QtY2FyZF9fZmF2b3JpdGVcIik7XG4gIGNvbnN0IHN3aXBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5teVN3aXBlcicpO1xuICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN3aXBlci13cmFwcGVyJyk7XG4gIGNvbnN0IHdpZHRoID0gd2luZG93LnNjcmVlbi5hdmFpbFdpZHRoO1xuXG4gIGJ1dHRvbjIub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIGJ1dHRvbjEucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJyM4NTkzYTInO1xuICAgIGJ1dHRvbjIucXVlcnlTZWxlY3RvcihcImxhYmVsXCIpLnN0eWxlLmJhY2tncm91bmQgPSAndXJsKGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeU1DSWdhR1ZwWjJoMFBTSXlNQ0lnZG1sbGQwSnZlRDBpTUNBd0lESXdJREl3SWo0S0lDQWdJRHhuSUdsa1BTSndjbVZtYVhoZlgybGpiMjVmZG1sbGQxOXliM2R6WDJGamRHbDJaU0lnWkdGMFlTMXVZVzFsUFNKcFkyOXVJSFpwWlhjZ2NtOTNjeUJoWTNScGRtVWlJSFJ5WVc1elptOXliVDBpZEhKaGJuTnNZWFJsS0MwdU1ESTVJQzB1TURJNUtTSStDaUFnSUNBZ0lDQWdQR2NnYVdROUluQnlaV1pwZUY5ZlVtVmpkR0Z1WjJ4bFh6RTROU0lnWkdGMFlTMXVZVzFsUFNKU1pXTjBZVzVuYkdVZ01UZzFJaUIwY21GdWMyWnZjbTA5SW5SeVlXNXpiR0YwWlNndU1ESTVJQzR3TWprcElpQnpkSGxzWlQwaWMzUnliMnRsT2lNd01EQTdjM1J5YjJ0bExYZHBaSFJvT2pOd2VEdG1hV3hzT201dmJtVWlQZ29nSUNBZ0lDQWdJQ0FnSUNBOGNtVmpkQ0IzYVdSMGFEMGlNakFpSUdobGFXZG9kRDBpTWpBaUlISjRQU0l4SWlCemRIbHNaVDBpYzNSeWIydGxPbTV2Ym1VaUx6NEtJQ0FnSUNBZ0lDQWdJQ0FnUEhKbFkzUWdkMmxrZEdnOUlqRTNJaUJvWldsbmFIUTlJakUzSWlCNFBTSXhMalVpSUhrOUlqRXVOU0lnY25nOUlpNDFJaUJ6ZEhsc1pUMGlabWxzYkRwdWIyNWxJaTgrQ2lBZ0lDQWdJQ0FnUEM5blBnb2dJQ0FnUEM5blBnbzhMM04yWno0SykgY2VudGVyIGNlbnRlciBuby1yZXBlYXQnO1xuICAgIGdyaWQyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSAncmVwZWF0KDEsMTAwJSknO1xuICAgIGltZy5mb3JFYWNoKGVsID0+IHtcbiAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7XG4gICAgfSk7XG4gICAgY2FyZEJsb2NrLmZvckVhY2goZWwgPT4ge1xuICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnZnVsbC1ncmlkJylcbiAgICB9KTtcbiAgfTtcbiAgaWYgKHdpZHRoID4gMTQ0MCkge1xuICAgIGJ1dHRvbjQub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgYnV0dG9uNC5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnYmxhY2snO1xuICAgICAgYnV0dG9uMy5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnIzg1OTNhMic7XG4gICAgICBncmlkMi5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gJ3JlcGVhdCgyLDM4JSknO1xuICAgICAgZ3JpZDIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnY2VudGVyJztcbiAgICAgIGNhcmRCbG9jay5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gJzkzNXB4JztcbiAgICAgIH0pO1xuICAgICAgaW1nQmxvY2suZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLm1heEhlaWdodCA9ICc4MzZweCc7XG4gICAgICB9KTtcblxuICAgICAgaGVhcnQuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKDgzMnB4KSc7XG4gICAgICB9KTtcblxuICAgICAgc3dpcGVyLmZvckVhY2goKGVsLCBpKSA9PiB7XG5cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgtNzMwcHgsIDBweCwgMHB4KSdcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuXG4gICAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KScgICAgICB9KVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBidXR0b24zLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIGJ1dHRvbjMucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJ2JsYWNrJztcbiAgICAgIGJ1dHRvbjQucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJyM4NTkzYTInO1xuICAgICAgZ3JpZDIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9ICdyZXBlYXQoNCwyNC41JSknO1xuICAgICAgZ3JpZDIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnbm9ybWFsJztcbiAgICAgIGNhcmRCbG9jay5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gJzY0MHB4JztcbiAgICAgIH0pO1xuICAgICAgaW1nQmxvY2suZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLm1heEhlaWdodCA9ICc1NjBweCc7XG4gICAgICB9KTtcblxuICAgICAgaGVhcnQuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKDU1OHB4KSc7XG4gICAgICB9KTtcblxuICAgICAgc3dpcGVyLmZvckVhY2goKGVsLCBpKSA9PiB7XG5cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgtNDg0cHgsIDBweCwgMHB4KSdcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuXG4gICAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KScgICAgICB9KVxuICAgICAgfSk7XG4gICAgfTtcbiAgfSBlbHNlIHtcblxuICAgIGJ1dHRvbjQub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgICAgYnV0dG9uNC5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnYmxhY2snO1xuICAgICAgYnV0dG9uMy5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpLnN0eWxlLmZpbGwgPSAnIzg1OTNhMjsnO1xuICAgICAgZ3JpZDIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9ICdyZXBlYXQoMiwzOCUpJztcbiAgICAgIGdyaWQyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2NlbnRlcic7XG4gICAgICBjYXJkQmxvY2suZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLmhlaWdodCA9ICc3NzJweCc7XG4gICAgICB9KTtcbiAgICAgIGltZ0Jsb2NrLmZvckVhY2goZWwgPT4ge1xuICAgICAgICBlbC5zdHlsZS5tYXhIZWlnaHQgPSAnODM2cHgnO1xuICAgICAgfSk7XG5cbiAgICAgIGhlYXJ0LmZvckVhY2goZWwgPT4ge1xuICAgICAgICBlbC5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgwKSc7XG4gICAgICB9KTtcblxuICAgICAgc3dpcGVyLmZvckVhY2goKGVsLCBpKSA9PiB7XG5cbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgtNTExcHgsIDBweCwgMHB4KSdcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuXG4gICAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgKGUpID0+IHtcbiAgICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwcHgsIDBweCwgMHB4KScgICAgICB9KVxuICAgICAgfSk7XG4gICAgfTtcbiAgICBidXR0b24zLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgIGJ1dHRvbjMucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJ2JsYWNrJztcbiAgICAgIGJ1dHRvbjQucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJyM4NTkzYTInO1xuICAgICAgZ3JpZDIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9ICdyZXBlYXQoNCwyNC41JSknO1xuICAgICAgZ3JpZDIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnbm9ybWFsJztcbiAgICAgIGNhcmRCbG9jay5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gJzUxNXB4JztcbiAgICAgIH0pO1xuICAgICAgaW1nQmxvY2suZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLm1heEhlaWdodCA9ICc1NjBweCc7XG4gICAgICB9KTtcblxuICAgICAgaGVhcnQuZm9yRWFjaChlbCA9PiB7XG4gICAgICAgIGVsLnN0eWxlLnRyYW5zZm9ybSA9ICdub25lJztcbiAgICAgIH0pO1xuXG4gICAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcblxuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoZSkgPT4ge1xuICAgICAgICAgIHdyYXBwZXJbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKC0zNDRweCwgMHB4LCAwcHgpJ1xuICAgICAgICB9KVxuICAgICAgfSk7XG5cbiAgICAgIHN3aXBlci5mb3JFYWNoKChlbCwgaSkgPT4ge1xuICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCAoZSkgPT4ge1xuICAgICAgICAgIHdyYXBwZXJbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKDBweCwgMHB4LCAwcHgpJyAgICAgIH0pXG4gICAgICB9KTtcbiAgICB9O1xuICB9XG4gIGJ1dHRvbjEub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIGJ1dHRvbjEucXVlcnlTZWxlY3RvcihcInN2Z1wiKS5zdHlsZS5maWxsID0gJ2JsYWNrJztcbiAgICBidXR0b24yLnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFwiKS5zdHlsZS5iYWNrZ3JvdW5kID0gJ3VybChkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXlNQ0lnYUdWcFoyaDBQU0l5TUNJZ2RtbGxkMEp2ZUQwaU1DQXdJREl3SURJd0lqNEtJQ0FnSUR4a1pXWnpQZ29nSUNBZ0lDQWdJRHh6ZEhsc1pUNEtJQ0FnSUNBZ0lDQWdJQ0FnTG1Oc2N5MHhMQzVqYkhNdE0zdG1hV3hzT201dmJtVjlMbU5zY3kweGUzTjBjbTlyWlRvak56ZzRNemt4TzNOMGNtOXJaUzEzYVdSMGFEb3ljSGg5TG1Oc2N5MHllM04wY205clpUcHViMjVsZlFvZ0lDQWdJQ0FnSUR3dmMzUjViR1UrQ2lBZ0lDQThMMlJsWm5NK0NpQWdJQ0E4WnlCcFpEMGlhV052Ymw5MmFXVjNYM0p2ZDNNaUlHUmhkR0V0Ym1GdFpUMGlhV052YmlCMmFXVjNJSEp2ZDNNaUlIUnlZVzV6Wm05eWJUMGlkSEpoYm5Oc1lYUmxLQzB1TURJNUlDMHVNREk1S1NJK0NpQWdJQ0FnSUNBZ1BHY2dhV1E5SWxKbFkzUmhibWRzWlY4eE9EVWlJR05zWVhOelBTSmpiSE10TVNJZ1pHRjBZUzF1WVcxbFBTSlNaV04wWVc1bmJHVWdNVGcxSWlCMGNtRnVjMlp2Y20wOUluUnlZVzV6YkdGMFpTZ3VNREk1SUM0d01qa3BJajRLSUNBZ0lDQWdJQ0FnSUNBZ1BISmxZM1FnZDJsa2RHZzlJakl3SWlCb1pXbG5hSFE5SWpJd0lpQmpiR0Z6Y3owaVkyeHpMVElpSUhKNFBTSXhJaTgrQ2lBZ0lDQWdJQ0FnSUNBZ0lEeHdZWFJvSUdROUlrMHhJREZvTVRoMk1UaElNWG9pSUdOc1lYTnpQU0pqYkhNdE15SXZQZ29nSUNBZ0lDQWdJRHd2Wno0S0lDQWdJRHd2Wno0S1BDOXpkbWMrQ2c9PSkgY2VudGVyIGNlbnRlciBuby1yZXBlYXQnO1xuXG4gICAgZ3JpZDIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9ICdyZXBlYXQoMiw1MCUpJztcbiAgICBpbWcuZm9yRWFjaChlbCA9PiB7XG4gICAgICBlbC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMS4yKSc7XG4gICAgfSk7XG5cbiAgfTtcbn07XG5cbmNvbnN0IGJ1cmdlclN1Ym1lbnUgPSAoKSA9PiB7XG4gIGxldCBtZW51RWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tYWluLWxpc3Rfc3VibWVudScpO1xuICBsZXQgdGl0bGVFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1haW4tbGlzdF9faXRlbScpO1xuXG5cbiAgdGl0bGVFbGVtWzBdLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aXRsZUVsZW1bMF0uY2xhc3NMaXN0LnRvZ2dsZSgnaXRlbS1vcGVuJylcbiAgICBtZW51RWxlbVswXS5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuJyk7XG4gIH07XG4gIHRpdGxlRWxlbVsxXS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgdGl0bGVFbGVtWzFdLmNsYXNzTGlzdC50b2dnbGUoJ2l0ZW0tb3BlbicpXG4gICAgbWVudUVsZW1bMV0uY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuICB9O1xuICB0aXRsZUVsZW1bM10ub25jbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIHRpdGxlRWxlbVszXS5jbGFzc0xpc3QudG9nZ2xlKCdpdGVtLW9wZW4nKVxuICAgIG1lbnVFbGVtWzJdLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgfTtcbiAgdGl0bGVFbGVtWzRdLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aXRsZUVsZW1bNF0uY2xhc3NMaXN0LnRvZ2dsZSgnaXRlbS1vcGVuJylcbiAgICBtZW51RWxlbVszXS5jbGFzc0xpc3QudG9nZ2xlKCdvcGVuJyk7XG4gIH07XG5cbn07XG5cbmNvbnN0IHNlYXJjaE9wZW49ICgpID0+IHtcbiAgbGV0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VhcmNoLWZvcm0nKTtcbiAgbGV0IGJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yaWdodC1ibG9ja19fYnRuLS1zZWFyY2gnKTtcbiAgbGV0IGNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlYXJjaC1mb3JtX19yZXNldCcpO1xuXG4gIGJ0bi5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBmb3JtWzBdLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgICBmb3JtWzFdLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcbiAgfTtcblxuICBjbG9zZS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBmb3JtLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTtcbiAgfTtcbn07XG5cbmNvbnN0IGFkZHJlc3NPcGVuID0gKCkgPT4ge1xuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlY29uZC1saXN0X19saW5rLS1hZGRyZXNzJyk7XG5cbiAgYWRkcmVzcy5mb3JFYWNoKChlbCkgPT4ge1xuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgZWwucHJldmVudERlZmF1bHQoKTtcbiAgICB9KVxuICB9KTtcblxufVxuXG5jb25zdCBzd2lwZXJQcmV3MSA9ICgpID0+IHtcbiAgY29uc3Qgc3dpcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm15U3dpcGVyJyk7XG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3dpcGVyLXdyYXBwZXInKTtcbiAgY29uc3Qgd2lkdGggPSB3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGg7XG5cbiAgaWYgKHdpZHRoID4gMTQ0MCkge1xuXG4gICAgc3dpcGVyLmZvckVhY2goKGVsLCBpKSA9PiB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoZSkgPT4ge1xuICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgtNDg0cHgsIDBweCwgMHB4KSdcbiAgICAgIH0pXG4gICAgfSk7XG5cbiAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIChlKSA9PiB7XG4gICAgICAgIHdyYXBwZXJbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKDBweCwgMHB4LCAwcHgpJyAgICAgIH0pXG4gICAgfSk7XG4gIH1cbiAgZWxzZSB7XG4gICAgc3dpcGVyLmZvckVhY2goKGVsLCBpKSA9PiB7XG4gICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCAoZSkgPT4ge1xuICAgICAgICB3cmFwcGVyW2ldLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgtMzQ0cHgsIDBweCwgMHB4KSdcbiAgICAgIH0pXG4gICAgfSk7XG5cbiAgICBzd2lwZXIuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIChlKSA9PiB7XG4gICAgICAgIHdyYXBwZXJbaV0uc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKDBweCwgMHB4LCAwcHgpJyAgICAgIH0pXG4gICAgfSk7XG4gIH1cblxuXG5cblxufTtcblxuXG5cblxuY29uc3QgaW5pdEZlZWRiYWNrTW9kYWwgPSAoKSA9PiB7XG4gIGNvbnN0IHdvcmtCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndvcmtfX2J0blwiKTtcbiAgY29uc3QgZmVlZGJhY2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZmVlZGJhY2stbW9kYWxcIik7XG5cbiAgd29ya0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGh0bWwuY2xhc3NMaXN0LmFkZChcImxvY2tcIik7XG4gICAgZmVlZGJhY2tNb2RhbC5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgfSk7XG59O1xuXG5jb25zdCBpbml0Q2xvc2VNb2RhbCA9ICgpID0+IHtcbiAgY29uc3QgbW9kYWxDbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZVwiKTtcblxuICBtb2RhbENsb3NlQnV0dG9ucy5mb3JFYWNoKGZ1bmN0aW9uIChidXR0b24pIHtcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGh0bWwuY2xhc3NMaXN0LnJlbW92ZShcImxvY2tcIik7XG4gICAgICBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5jb25zdCBvdmVybGF5Q2xvc2UgPSAoKSA9PiB7XG4gIGNvbnN0IGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19vdmVybGF5XCIpO1xuICBlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBpZiAoZSA9PSBldmVudC50YXJnZXQpIHtcbiAgICAgIGh0bWwuY2xhc3NMaXN0LnJlbW92ZShcImxvY2tcIik7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJvcGVuXCIpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5cblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgKCkgPT4ge1xuICBpbml0Rml4ZWRIZWFkZXIoKTtcbn0pO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFxuICBcIkRPTUNvbnRlbnRMb2FkZWRcIixcbiAgZnVuY3Rpb24gKCkge1xuICAgIGluaXRGaXhlZEhlYWRlcigpO1xuICAgIHN3aXRjaGVyQnV0dG9uKCk7XG4gICAgYnVyZ2VyU3VibWVudSgpO1xuICAgIHN3aXBlclByZXcxKCk7XG4gICAgc2VhcmNoT3BlbigpO1xuICAgIGFkZHJlc3NPcGVuKCk7XG4gICAgY2F0YWxvZ1Rvb2dsZSgpO1xuICAgIHBvcHVwSW5pdCgpO1xuICAgIGluaXRGaXhlZE1lbnUoKTtcbiAgfSxcbiAgZmFsc2Vcbik7XG4iLCIiLCJjb25zdCBwb3N0Rm9ybSA9IGFzeW5jICh1cmwsIGRhdGEpID0+IHtcbiAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICBtZXRob2Q6IGBQT1NUYCxcblxuICAgICAgaGVhZGVyczoge1xuXG5cbiAgICAgICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG5cblxuICAgICAgfSxcbiAgICAgIGJvZHk6IGRhdGFcblxuICB9KTtcblxuICByZXR1cm4gYXdhaXQgcmVzLmpzb24oKTtcbn07XG5cbmNvbnN0IGdldFJlcyA9IGFzeW5jICh1cmwpID0+IHtcbiAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsKTtcblxuICBpZighcmVzLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmZXRjaCAke3VybH0sIHN0YXR1cyAke3Jlcy5zdGF0dXN9YCk7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgcmVzLmpzb24oKTtcbn07XG4iLCJcbmNvbnN0IHNsaWRlciA9ICgpPT57XG4gIGxldCBsYXJnZVNsaWRlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubXlTd2lwZXInKVxuICBsZXQgcHJldkFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN3aXBlci1idXR0b24tcHJldicpXG4gIGxldCBuZXh0QXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3dpcGVyLWJ1dHRvbi1uZXh0JylcbiAgbGFyZ2VTbGlkZXJzLmZvckVhY2goKHNsaWRlciwgaW5kZXgpPT57XG4gICAgbGV0IHNsaWRlckxlbmd0aCA9IHNsaWRlci5jaGlsZHJlblswXS5jaGlsZHJlbi5sZW5ndGhcbiAgICBsZXQgcmVzdWx0ID0gKHNsaWRlckxlbmd0aCA+IDEpID8gdHJ1ZSA6IGZhbHNlXG4gICAgY29uc3Qgc3dpcGVyID0gbmV3IFN3aXBlcihzbGlkZXIsIHtcbiAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICBzbGlkZXNQZXJWaWV3OiAxLFxuICAgICAgc3BhY2VCZXR3ZWVuOiA0MCxcbiAgICAgIG5hdmlnYXRpb246IHtcbiAgICAgICAgbmV4dEVsOiBuZXh0QXJyb3dbaW5kZXhdLFxuICAgICAgICBwcmV2RWw6IHByZXZBcnJvd1tpbmRleF0sXG4gICAgICB9XG4gICAgfSk7XG4gIH0pXG4gIGlmICh3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGggPCAxMzY1KSB7XG4gICAgbGV0IHNsaWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5teVN3aXBlcjInKVxuICAgIGxldCBwcmV2QXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3dpcGVyLWJ1dHRvbi1wcmV2JylcbiAgICBsZXQgbmV4dEFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN3aXBlci1idXR0b24tbmV4dCcpXG5cbiAgICBjb25zdCBzd2lwZXIgPSBuZXcgU3dpcGVyKHNsaWRlciwge1xuICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgICBzcGFjZUJldHdlZW46IDQwLFxuICAgICAgbmF2aWdhdGlvbjoge1xuICAgICAgICBuZXh0RWw6IG5leHRBcnJvdyxcbiAgICAgICAgcHJldkVsOiBwcmV2QXJyb3csXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxuXG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgc2xpZGVyKTtcblxuXG5cblxuXG4iXX0=
